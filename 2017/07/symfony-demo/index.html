<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Vài thứ hay ho từ Symfony Demo | Tư Duy Đơn Giản</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Bữa nay rảnh rỗi clone Symfony demo (ver hiện tại chạy với Symfony 3.3.*) về để xem thử mặt mũi nó thế nào, và cũng quả không phí, có vài thứ bản thân nhận thấy khá là hay ho.">
<meta name="keywords" content="best practice">
<meta property="og:type" content="article">
<meta property="og:title" content="Vài thứ hay ho từ Symfony Demo">
<meta property="og:url" content="https://tuduydongian.com/2017/07/symfony-demo/index.html">
<meta property="og:site_name" content="Tư Duy Đơn Giản">
<meta property="og:description" content="Bữa nay rảnh rỗi clone Symfony demo (ver hiện tại chạy với Symfony 3.3.*) về để xem thử mặt mũi nó thế nào, và cũng quả không phí, có vài thứ bản thân nhận thấy khá là hay ho.">
<meta property="og:updated_time" content="2017-11-13T16:54:15.591Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Vài thứ hay ho từ Symfony Demo">
<meta name="twitter:description" content="Bữa nay rảnh rỗi clone Symfony demo (ver hiện tại chạy với Symfony 3.3.*) về để xem thử mặt mũi nó thế nào, và cũng quả không phí, có vài thứ bản thân nhận thấy khá là hay ho.">
<meta name="twitter:creator" content="@tuduydongian">
<meta property="fb:admins" content="100000290423290">
<meta property="fb:app_id" content="124307384811590">
  
    <link rel="alternate" href="/atom.xml" title="Tư Duy Đơn Giản" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-100038903-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


</head>

<body>
  
<!-- Facebook SDK -->
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.9&appId=124307384811590";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<!-- End Facebook SDK -->


  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Tư Duy Đơn Giản</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">Nghĩ đơn giản, làm đơn giản</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://tuduydongian.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-2017/07/symfony-demo" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/07/symfony-demo/" class="article-date">
  <time datetime="2017-07-25T17:00:00.000Z" itemprop="datePublished">2017-07-26</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/symfony/">symfony</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Vài thứ hay ho từ Symfony Demo
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Bữa nay rảnh rỗi clone Symfony demo (ver hiện tại chạy với Symfony 3.3.*) về để xem thử mặt mũi nó thế nào, và cũng quả không phí, có vài thứ bản thân nhận thấy khá là hay ho.</p>
<a id="more"></a> 
<h3 id="Khong-handle-duoc-noi-dung-cua-logout-action"><a href="#Khong-handle-duoc-noi-dung-cua-logout-action" class="headerlink" title="Không handle được nội dung của logout action"></a>Không handle được nội dung của logout action</h3><p>Khi bạn configure logout của firewall như này:</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="attr">security:</span></div><div class="line"><span class="attr">    firewalls:</span></div><div class="line"><span class="attr">        secured_area:</span></div><div class="line"><span class="attr">            logout:</span></div><div class="line"><span class="attr">                path:</span> <span class="string">security_logout</span></div></pre></td></tr></table></figure>
<p>Done, khi bạn tạo một route mới với name là <code>security_logout</code> thì xin chúc mừng, Symfony sẽ tự động handle việc logout của user và bạn sẽ chả làm được gì ở cái action này</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Symfony will intercept this first and handle the logout automatically.</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> * <span class="doctag">@Route</span>("/logout", name="security_logout")</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">logoutAction</span><span class="params">()</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> \<span class="keyword">Exception</span>(<span class="string">'Never hit to here :(('</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Symfony-Styles"><a href="#Symfony-Styles" class="headerlink" title="Symfony Styles"></a>Symfony Styles</h3><p>Bắt đầu từ Symfony 2.7, <code>Symfony Styles</code> được giới thiệu. Công việc của nó là giúp cho các command bạn viết ra được <code>consistent</code>. Và việc sử dụng nó gần như là bắt buộc nếu các command của bạn có sự tương tác cao khi sử dụng (như render <code>list</code>, <code>table</code>, <code>process bar</code>, <code>confirm</code>, …)</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">GreetCommand</span> <span class="keyword">extends</span> <span class="title">ContainerAwareCommand</span></span></div><div class="line"><span class="class"></span>&#123;</div><div class="line">    <span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">execute</span><span class="params">(InputInterface $input, OutputInterface $output)</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        $io = <span class="keyword">new</span> SymfonyStyle($input, $output);</div><div class="line">        $io-&gt;title(<span class="string">'Lorem Ipsum Dolor Sit Amet'</span>);</div><div class="line"></div><div class="line">        <span class="comment">// ...</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Xem thêm về cháu nó: <a href="http://symfony.com/doc/current/console/style.html" target="_blank" rel="external">Symfony Styles</a></p>
<h3 id="Submit-form-with-multiple-buttons"><a href="#Submit-form-with-multiple-buttons" class="headerlink" title="Submit form with multiple buttons"></a>Submit form with multiple buttons</h3><p>Trong trường hợp form của bạn có nhiều submmit buttons thì bạn handle nó bằng việc kiểm tra <code>isClicked</code> của button đó. (Lưu ý: submmit button add trong template nhé, đừng như ví dụ bên dưới)</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">$form = <span class="keyword">$this</span>-&gt;createFormBuilder($task)</div><div class="line">    -&gt;add(<span class="string">'task'</span>, TextType::class)</div><div class="line">    -&gt;add(<span class="string">'save'</span>, SubmitType::class, <span class="keyword">array</span>(<span class="string">'label'</span> =&gt; <span class="string">'Create Task'</span>))</div><div class="line">    -&gt;add(<span class="string">'saveAndAdd'</span>, SubmitType::class, <span class="keyword">array</span>(<span class="string">'label'</span> =&gt; <span class="string">'Save and Add'</span>))</div><div class="line">    -&gt;getForm();</div><div class="line"></div><div class="line"><span class="keyword">if</span> ($form-&gt;isSubmitted() &amp;&amp; $form-&gt;isValid()) &#123;</div><div class="line">    $nextAction = $form-&gt;get(<span class="string">'saveAndAdd'</span>)-&gt;isClicked()</div><div class="line">        ? <span class="string">'task_new'</span></div><div class="line">        : <span class="string">'task_success'</span>;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;redirectToRoute($nextAction);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Xem thêm: <a href="https://symfony.com/doc/current/form/multiple_buttons.html" target="_blank" rel="external">How to Submit a Form with Multiple Buttons</a></p>
<h3 id="Viec-check-form-gt-isSubmmited-chi-la-optional"><a href="#Viec-check-form-gt-isSubmmited-chi-la-optional" class="headerlink" title="Việc check $form-&gt;isSubmmited() chỉ là optional"></a>Việc check <code>$form-&gt;isSubmmited()</code> chỉ là optional</h3><p>Bình thường lúc viết code ta sẽ viết như này:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> ($form-&gt;isSubmitted() &amp;&amp; $form-&gt;isValid()) &#123;</div><div class="line">    $post = $form-&gt;getData();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Thực tế thì việc check <code>$form-&gt;isSubmitted()</code> là không cần thiết vì <code>$form-&gt;isValid()</code> đã ôm luôn việc check submmited trong đó rồi. Vậy tại sao ta vẫn cứ viết như vậy? Câu trả lời là vì thuận miệng, thuận mắt (from Symfony demo: <code>to improve code readability</code>)</p>
<h3 id="Security-annotation"><a href="#Security-annotation" class="headerlink" title="Security annotation"></a>Security annotation</h3><p>Khi bạn giỏi tiếng Anh và thích viết những message exception thật trất thì:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"> * <span class="doctag">@Method</span>("GET")</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">showAction</span><span class="params">(Post $post)</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    <span class="keyword">$this</span>-&gt;denyAccessUnlessGranted(<span class="string">'show'</span>, $post, <span class="string">'Posts can only be shown to their authors.'</span>);</div><div class="line">    </div><div class="line">    dump($post);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Tuy nhiên dốt thì không có quyền được deep, âu cơ, sử dụng annotation, khỏi message gì sất:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"> * <span class="doctag">@Method</span>("GET")</span></div><div class="line"><span class="comment"> * <span class="doctag">@Security</span>("is_granted('show', post)")</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">showAction</span><span class="params">(Post $post)</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    dump($post);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Define-util-as-service"><a href="#Define-util-as-service" class="headerlink" title="Define util as service"></a>Define util as service</h3><p>Đây là cái mình thấy khá dị từ Symfony demo và một vài opensource khác, define thành service hết bất kể (<code>static function</code> là cái gì dạ?). Không biết nên thế nào là hợp lý hơn và xin nhắc lại tí:</p>
<ul>
<li>Service nếu không gọi đến thì nó cũng chả tự chạy đâu mà sợ tốn memory</li>
<li>Symfony giờ đã có <code>autowired</code>, xài service éo cần quan tâm cháu nó tên gì nữa, cứ pass nó thành args của action mà táng</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">editAction</span><span class="params">(Request $request, Post $post, Slugger $slugger)</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    $name = $request-&gt;request-&gt;get(<span class="string">'name'</span>);</div><div class="line"></div><div class="line">    $post-&gt;setName($name);</div><div class="line">    $post-&gt;setSlug($slugger-&gt;generate($name));</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Render-controller"><a href="#Render-controller" class="headerlink" title="Render controller"></a>Render controller</h3><p>Thử tưởng tượng bạn render một page <code>show post</code> có phần <code>related posts</code>. Có nhiều cách để làm được cái phần đó như là:</p>
<ul>
<li>query đống posts đó ra ngay trong <code>showPostAction</code> và render như phình phường</li>
<li>render cháu nó bằng ajax append</li>
<li>viết 1 action mới (không nhất thiết phải có router) và render cháu nó trong template của <code>showPostAction</code>. Đây là cách khuyến cáo vì nó sáng sủa và rõ ràng</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">relatedPostsAction</span><span class="params">(Post $post)</span> </span>&#123;</div><div class="line">    $posts = $repository-&gt;findRelated($post);</div><div class="line"></div><div class="line">    <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;render(...);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">showPostAction</span><span class="params">(Post $post)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;render(...);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// template of showPostAction</span></div><div class="line">&#123;&#123; render(controller(<span class="string">'AppBundle:Blog:relatedPosts'</span>, &#123;<span class="string">'id'</span>: post.id&#125;)) &#125;&#125;</div></pre></td></tr></table></figure>
<h3 id="DependentFixtureInterface"><a href="#DependentFixtureInterface" class="headerlink" title="DependentFixtureInterface"></a>DependentFixtureInterface</h3><p>Khi tạo <code>DataFixture</code>, có những data set bạn cần phải có data từ những fixture trước. VD: khi chạy fixture <code>Order</code>, bạn cần có <code>Product</code>, <code>Customer</code> trước. Để giải quyết, bạn có 2 cách:</p>
<ul>
<li>Sử dụng <code>OrderedFixtureInterface</code> (thô thiển và mất công handle order number)</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Customer</span> <span class="keyword">implements</span> <span class="title">FixtureInterface</span>, <span class="title">OrderedFixtureInterface</span> </span>&#123;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">load</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;addReference(<span class="string">'foo'</span>, $foo);    </div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getOrder</span><span class="params">()</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Product</span> <span class="keyword">implements</span> <span class="title">FixtureInterface</span>, <span class="title">OrderedFixtureInterface</span> </span>&#123;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">load</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;addReference(<span class="string">'bar'</span>, $bar);    </div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getOrder</span><span class="params">()</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Order</span> <span class="keyword">implements</span> <span class="title">FixtureInterface</span>, <span class="title">OrderedFixtureInterface</span> </span>&#123;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">load</span><span class="params">()</span> </span>&#123;</div><div class="line">        $customer = <span class="keyword">$this</span>-&gt;getReference(<span class="string">'foo'</span>);</div><div class="line">        $product = <span class="keyword">$this</span>-&gt;getReference(<span class="string">'bar'</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getOrder</span><span class="params">()</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="number">2</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>Xài <code>DependentFixtureInterface</code> &lt;- right way, code sẽ clean hơn RẤT RẤT nhiều</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Customer</span> <span class="keyword">implements</span> <span class="title">FixtureInterface</span> </span>&#123;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">load</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;addReference(<span class="string">'foo'</span>, $foo);    </div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Product</span> <span class="keyword">implements</span> <span class="title">FixtureInterface</span> </span>&#123;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">load</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;addReference(<span class="string">'bar'</span>, $bar);    </div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Order</span> <span class="keyword">implements</span> <span class="title">FixtureInterface</span>, <span class="title">DependentFixtureInterface</span> </span>&#123;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">load</span><span class="params">()</span> </span>&#123;</div><div class="line">        $customer = <span class="keyword">$this</span>-&gt;getReference(<span class="string">'foo'</span>);</div><div class="line">        $product = <span class="keyword">$this</span>-&gt;getReference(<span class="string">'bar'</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getDependencies</span><span class="params">()</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="keyword">return</span> [</div><div class="line">            Customer::class,</div><div class="line">            Product::class,</div><div class="line">        ];</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Trans-everywhere"><a href="#Trans-everywhere" class="headerlink" title="Trans everywhere"></a>Trans everywhere</h3><p>Bạn có thể apply được trans ở rất nhiều chỗ (controller, template,…) trong đó có <code>Entiy constraints message</code> &amp; <code>form label</code> (và tất nhiên, trans hay không là tùy bạn, mình thì nhác)</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">use</span> <span class="title">Symfony</span>\<span class="title">Component</span>\<span class="title">Validator</span>\<span class="title">Constraints</span> <span class="title">as</span> <span class="title">Assert</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Post</span></span></div><div class="line"><span class="class"></span>&#123;</div><div class="line">    <span class="comment">/**</span></div><div class="line"><span class="comment">     * <span class="doctag">@var</span> string</span></div><div class="line"><span class="comment">     *</span></div><div class="line"><span class="comment">     * <span class="doctag">@ORM</span>\Column(type="string")</span></div><div class="line"><span class="comment">     * <span class="doctag">@Assert</span>\NotBlank(message="post.blank_summary")</span></div><div class="line"><span class="comment">     */</span></div><div class="line">    <span class="keyword">private</span> $summary;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line"><span class="comment">     * <span class="doctag">@var</span> string</span></div><div class="line"><span class="comment">     *</span></div><div class="line"><span class="comment">     * <span class="doctag">@ORM</span>\Column(type="text")</span></div><div class="line"><span class="comment">     * <span class="doctag">@Assert</span>\NotBlank(message="post.blank_content")</span></div><div class="line"><span class="comment">     * <span class="doctag">@Assert</span>\Length(min=10, minMessage="post.too_short_content")</span></div><div class="line"><span class="comment">     */</span></div><div class="line">    <span class="keyword">private</span> $content;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">PostType</span> <span class="keyword">extends</span> <span class="title">AbstractType</span></span></div><div class="line"><span class="class"></span>&#123;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">buildForm</span><span class="params">(FormBuilderInterface $builder, array $options)</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        $builder-&gt;add(<span class="string">'title'</span>, <span class="keyword">null</span>, [</div><div class="line">            <span class="string">'attr'</span> =&gt; [<span class="string">'autofocus'</span> =&gt; <span class="keyword">true</span>],</div><div class="line">            <span class="string">'label'</span> =&gt; <span class="string">'label.title'</span>,</div><div class="line">        ]);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Data-provider-and-yield"><a href="#Data-provider-and-yield" class="headerlink" title="Data provider and yield"></a>Data provider and yield</h3><p>Biết cái <code>yield</code> này rồi mới thấy hồi viết data provider mình bị ngu các bợn ạ. À, tất nhiên bạn thích dùng kiểu nào là tùy nhé, mình chả nói gì đâu :troll:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * <span class="doctag">@dataProvider</span> getUrlsForRegularUsers</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">testAccessDeniedForRegularUsers</span><span class="params">($httpMethod, $url)</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    $client-&gt;request($httpMethod, $url);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Old</span></div><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getUrlsForRegularUsers</span><span class="params">()</span>: <span class="title">array</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    <span class="keyword">return</span> [</div><div class="line">        [<span class="string">'GET'</span>, <span class="string">'/en/admin/post/'</span>],</div><div class="line">        [<span class="string">'GET'</span>, <span class="string">'/en/admin/post/1'</span>],</div><div class="line">        [<span class="string">'GET'</span>, <span class="string">'/en/admin/post/1/edit'</span>],</div><div class="line">        [<span class="string">'POST'</span>, <span class="string">'/en/admin/post/1/delete'</span>]</div><div class="line">    ];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// New</span></div><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getUrlsForRegularUsers</span><span class="params">()</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    <span class="keyword">yield</span> [<span class="string">'GET'</span>, <span class="string">'/en/admin/post/'</span>];</div><div class="line">    <span class="keyword">yield</span> [<span class="string">'GET'</span>, <span class="string">'/en/admin/post/1'</span>];</div><div class="line">    <span class="keyword">yield</span> [<span class="string">'GET'</span>, <span class="string">'/en/admin/post/1/edit'</span>];</div><div class="line">    <span class="keyword">yield</span> [<span class="string">'POST'</span>, <span class="string">'/en/admin/post/1/delete'</span>];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Âu cơ, đây là những thứ mình thấy hay ho khi lần đầu tiên thực sự clone Symfony demo về máy thay vì cưỡi ngựa xem hoa qua giao diện UI của github.</p>
<p>Về cơ bản, nó là những kiến thức cơ bản nên nếu cơ bản bạn thấy nó cơ bản thì đúng là nó cơ bản thật và đừng cười mình nhé :troll:</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://tuduydongian.com/2017/07/symfony-demo/" data-id="cj9yfla0x001qdcn28pb10ywx" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/best-practice/">best practice</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2017/07/async-simple/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Async thật đơn giản
        
      </div>
    </a>
  
  
    <a href="/2017/07/webpack-simple-2/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Webpack thật đơn giản phần 2</div>
    </a>
  
</nav>

  
</article>



  <section id="comments">
  <div class="fb-comments" data-href="https://tuduydongian.com/2017/07/symfony-demo/index.html" data-width="100%" data-numposts="10"></div>
</section>
</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/devops/">devops</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/frontend/">frontend</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/js/">js,</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/php/">php</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/symfony/">symfony</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/tools/">tools</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/ansible/">ansible</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/async/">async</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/best-practice/">best practice</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/bootstrap-native/">bootstrap-native</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cheatsheet/">cheatsheet</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gitlab/">gitlab</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js/">js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/terminal/">terminal</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tips/">tips</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/webpack/">webpack</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/ansible/" style="font-size: 10px;">ansible</a> <a href="/tags/async/" style="font-size: 10px;">async</a> <a href="/tags/best-practice/" style="font-size: 20px;">best practice</a> <a href="/tags/bootstrap-native/" style="font-size: 10px;">bootstrap-native</a> <a href="/tags/cheatsheet/" style="font-size: 12.5px;">cheatsheet</a> <a href="/tags/git/" style="font-size: 15px;">git</a> <a href="/tags/gitlab/" style="font-size: 10px;">gitlab</a> <a href="/tags/js/" style="font-size: 17.5px;">js</a> <a href="/tags/terminal/" style="font-size: 10px;">terminal</a> <a href="/tags/tips/" style="font-size: 10px;">tips</a> <a href="/tags/webpack/" style="font-size: 15px;">webpack</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2017/10/secure-gitlab-letsencrypt/">Bảo mật Gitlab với Let&#39;s Encrypt</a>
          </li>
        
          <li>
            <a href="/2017/10/single-action-controller/">Single Action Controller</a>
          </li>
        
          <li>
            <a href="/2017/09/optimize-webpack-bundle/">Tối ưu hoá webpack bundle</a>
          </li>
        
          <li>
            <a href="/2017/09/async-simple-p2/">Asyn thật đơn giản(P2)</a>
          </li>
        
          <li>
            <a href="/2017/09/symfony-service-decoration/">Symfony Service Decoration</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 tuduydongian.com
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>