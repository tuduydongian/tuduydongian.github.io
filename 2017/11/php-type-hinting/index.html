<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>PHP Type hinting | Tư Duy Đơn Giản</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Có thể bạn đã biết, tự cổ chí kim, PHP luôn được dành những cái nhìn đầy ác cảm từ các lập trình viên Java hoặc .Net. Một trong những lý do đặc trưng chính là v">
<meta name="keywords" content="best practice">
<meta property="og:type" content="article">
<meta property="og:title" content="PHP Type hinting">
<meta property="og:url" content="https://tuduydongian.com/2017/11/php-type-hinting/index.html">
<meta property="og:site_name" content="Tư Duy Đơn Giản">
<meta property="og:description" content="Có thể bạn đã biết, tự cổ chí kim, PHP luôn được dành những cái nhìn đầy ác cảm từ các lập trình viên Java hoặc .Net. Một trong những lý do đặc trưng chính là việc định kiểu lỏng lẻo (mixed), không nh">
<meta property="og:updated_time" content="2017-11-30T16:33:19.200Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="PHP Type hinting">
<meta name="twitter:description" content="Có thể bạn đã biết, tự cổ chí kim, PHP luôn được dành những cái nhìn đầy ác cảm từ các lập trình viên Java hoặc .Net. Một trong những lý do đặc trưng chính là việc định kiểu lỏng lẻo (mixed), không nh">
<meta name="twitter:creator" content="@tuduydongian">
<meta property="fb:admins" content="100000290423290">
<meta property="fb:app_id" content="124307384811590">
  
    <link rel="alternate" href="/atom.xml" title="Tư Duy Đơn Giản" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-100038903-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


</head>

<body>
  
<!-- Facebook SDK -->
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.9&appId=124307384811590";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<!-- End Facebook SDK -->


  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Tư Duy Đơn Giản</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">Nghĩ đơn giản, làm đơn giản</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://tuduydongian.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-2017/11/php-type-hinting" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/11/php-type-hinting/" class="article-date">
  <time datetime="2017-11-12T17:00:00.000Z" itemprop="datePublished">2017-11-13</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/php/">php</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      PHP Type hinting
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Có thể bạn đã biết, tự cổ chí kim, PHP luôn được dành những cái nhìn đầy ác cảm từ các lập trình viên <code>Java</code> hoặc <code>.Net</code>. Một trong những lý do đặc trưng chính là việc định kiểu lỏng lẻo (mixed), không nhất quán, phụ thuộc vào giá trị được gán. Và sau vài lần releases thì tới PHP 7.x, <code>Type Declarations</code> và <code>Return type declarations</code> ra đời đã giải quyết gần như triệt để vấn đề này.</p>
<a id="more"></a>
<p>Để tránh nêu đi nêu lại mớ kiến thức rõ ràng, bạn vui lòng xem về <code>Type Declarations</code> (thực chất là bản upgrade của cái tên thân thiện hơn từ PHP 5.x là <code>Type Hints</code>) và <code>Return type declarations</code> đã được giới thiệu rất chi tiết tại đây: </p>
<ul>
<li><a href="http://php.net/manual/en/functions.arguments.php#functions.arguments.type-declaration" target="_blank" rel="noopener">http://php.net/manual/en/functions.arguments.php#functions.arguments.type-declaration</a></li>
<li><a href="http://php.net/manual/en/functions.returning-values.php#functions.returning-values.type-declaration" target="_blank" rel="noopener">http://php.net/manual/en/functions.returning-values.php#functions.returning-values.type-declaration</a></li>
</ul>
<p>Note: từ giờ mình xin gọi ngắn gọn bộ combo <code>Type Declarations</code> và <code>Return type declarations</code> là <code>Type hinting</code>.</p>
<h3 id="Tai-sao-nhat-dinh-phai-dung-Type-hinting"><a href="#Tai-sao-nhat-dinh-phai-dung-Type-hinting" class="headerlink" title="Tại sao nhất định phải dùng Type hinting?"></a>Tại sao nhất định phải dùng Type hinting?</h3><p>Thỉnh thoảng mình có nhận trách nhiệm review code của đồng nghiệp, và cái mà mình thường nhắc nhở các bạn chính là vấn đề về <code>Type hinting</code>. Thử tưởng tượng bạn thấy một hàm như thế này:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">readFile</span><span class="params">($filename)</span></span>;</span><br></pre></td></tr></table></figure>
<p>Tên hàm là <code>readFile</code>, rất là readable. Vậy giờ gọi hàm này như thế nào?</p>
<p><code>$filename</code> là đường dẫn tuyệt đối?</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">readFile(<span class="string">'/path/to/file.txt'</span>);</span><br></pre></td></tr></table></figure>
<p>hay là file handle?</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">readFile(fopen(<span class="string">'/path/to/file.txt'</span>, <span class="string">'r'</span>));</span><br></pre></td></tr></table></figure>
<p>hay là 1 class wrapper:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">readFile(<span class="keyword">new</span> UploadedFle(<span class="string">'/path/to/file.txt'</span>));</span><br></pre></td></tr></table></figure>
<p>Ok, fine. Nếu không có document, để có thể sử dụng được hàm này, bắt buộc bạn phải đọc code của hàm để biết rốt cuộc <code>$filename</code> nó là cái gì. Mọi việc sẽ dễ dàng hơn nếu ta khai báo hàm trên với <code>Type hinting</code>:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">readFile</span><span class="params">(string $filename)</span>: <span class="title">string</span></span></span><br></pre></td></tr></table></figure>
<p>Lợi ích:</p>
<ul>
<li>Biết được kiểu của biến truyền vào.</li>
<li>Biết được kiểu của giá trị trả về.</li>
<li>Dễ dàng reference variable (Find variable usages).</li>
</ul>
<p>Vậy liệu <code>Type hinting</code> đã thực sự tốt? Theo mình thì chưa nếu đặt cùng trên một bàn cân so với các ngôn ngữ khác như <code>.Net</code>, <code>Golang</code>, … Như đã đề cập ở đầu bài viết, sức mạnh hiện tại của <code>Type hinting</code> chỉ đủ để <code>giải quyết gần như triệt để</code>. Xét case đặc trưng sau:</p>
<h3 id="Truong-hop-dinh-kieu-cua-array"><a href="#Truong-hop-dinh-kieu-cua-array" class="headerlink" title="Trường hợp định kiểu của array"></a>Trường hợp định kiểu của array</h3><p>Với các ngôn ngữ khác, việc định kiểu như sau đây được thực hiện rất dễ dàng, tuy nhiên hiện tại là không thể đối với PHP:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">setTags</span><span class="params">(array&lt;Tag&gt; $tags)</span></span>;</span><br><span class="line"><span class="comment">// usage:</span></span><br><span class="line">setTags([<span class="keyword">new</span> Tag(), <span class="keyword">new</span> Tag()]);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getPosts</span><span class="params">()</span>: <span class="title">array</span>&lt;<span class="title">Post</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>Với hàm <code>setTags</code> ta có thể linh động thay đổi 1 tí như sau với variadic arguments (chính xác là nhiều tí vì đầu vào không còn là array nữa):</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">setTags</span><span class="params">(Tag... $tags)</span></span></span><br><span class="line"><span class="function">// <span class="title">usage</span>:</span></span><br><span class="line"><span class="function"><span class="title">setTags</span><span class="params">(new Tag<span class="params">()</span>, new Tag<span class="params">()</span>)</span></span>;</span><br></pre></td></tr></table></figure>
<p>Xem thêm: <a href="http://php.net/manual/en/functions.arguments.php#functions.variable-arg-list" target="_blank" rel="noopener">http://php.net/manual/en/functions.arguments.php#functions.variable-arg-list</a></p>
<p>Tuy nhiên không may là cách trên không áp dụng được với trường hợp <code>Return type</code> (và bản thân mình cũng chưa có dịp sử dụng cái cách phía trên nên về cơ bản nhìn nó khá là NGU). Vậy người nông dân phải làm thế nào?</p>
<p>Hiện tại, lựa chọn duy nhất để giải quyết case này là nương nhờ vào <code>PhpDoc</code> (docblock) và khả năng đọc hiểu của IDE. Tất nhiên, chương trình của chúng ta sẽ không throw ra Runtime Error nếu kiểu dữ liệu truyền vào bị sai; đây thực sự là <code>Type hinting</code> đúng nghĩa:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> Tag[] $tags</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">setTags</span><span class="params">(array $tags)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> Post[]</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getPosts</span><span class="params">()</span>: <span class="title">array</span></span></span><br></pre></td></tr></table></figure>
<p>Hi vọng vào lần update tới, PHP sẽ có phương án giải quyết triệt để vấn đề này.</p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>Túm cái váy lại:</p>
<ul>
<li>Nếu có thể dùng Type-hint, BẮT BUỘC phải dùng Type-hint</li>
<li>Nếu không thể dùng Type-hint, BẮT BUỘC document đầy đủ về kiểu dữ liệu của biến ở docblock</li>
<li>Trường hợp Type-hint của array, BẮT BUỘC đọc lại đoạn trên nhé :smile:</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://tuduydongian.com/2017/11/php-type-hinting/" data-id="cjampbbdr001uipnfc61fqv86" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/best-practice/">best practice</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2017/11/async-await/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Async/Await trong javascript
        
      </div>
    </a>
  
  
    <a href="/2017/10/secure-gitlab-letsencrypt/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Bảo mật Gitlab với Let&#39;s Encrypt</div>
    </a>
  
</nav>

  
</article>



  <section id="comments">
  <div class="fb-comments" data-href="https://tuduydongian.com/2017/11/php-type-hinting/index.html" data-width="100%" data-numposts="10"></div>
</section>
</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/devops/">devops</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/frontend/">frontend</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/javascript/">javascript</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/js/">js,</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/nodejs/">nodejs</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/php/">php</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/symfony/">symfony</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/tools/">tools</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/ansible/">ansible</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/async/">async</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/best-practice/">best practice</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/bootstrap-native/">bootstrap-native</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cheatsheet/">cheatsheet</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/chrome-headless/">chrome headless</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gitlab/">gitlab</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js/">js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js-async/">js async</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/puppeteer/">puppeteer</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/terminal/">terminal</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tips/">tips</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/webpack/">webpack</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/ansible/" style="font-size: 10px;">ansible</a> <a href="/tags/async/" style="font-size: 10px;">async</a> <a href="/tags/best-practice/" style="font-size: 20px;">best practice</a> <a href="/tags/bootstrap-native/" style="font-size: 10px;">bootstrap-native</a> <a href="/tags/cheatsheet/" style="font-size: 12.5px;">cheatsheet</a> <a href="/tags/chrome-headless/" style="font-size: 10px;">chrome headless</a> <a href="/tags/git/" style="font-size: 15px;">git</a> <a href="/tags/gitlab/" style="font-size: 10px;">gitlab</a> <a href="/tags/js/" style="font-size: 17.5px;">js</a> <a href="/tags/js-async/" style="font-size: 10px;">js async</a> <a href="/tags/puppeteer/" style="font-size: 10px;">puppeteer</a> <a href="/tags/terminal/" style="font-size: 10px;">terminal</a> <a href="/tags/tips/" style="font-size: 10px;">tips</a> <a href="/tags/webpack/" style="font-size: 15px;">webpack</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2017/11/browser-automation-chrome-headless-puppeteer/">Tự động hoá browser với Chrome headless - Puppeteer - Nodejs</a>
          </li>
        
          <li>
            <a href="/2017/11/async-await/">Async/Await trong javascript</a>
          </li>
        
          <li>
            <a href="/2017/11/php-type-hinting/">PHP Type hinting</a>
          </li>
        
          <li>
            <a href="/2017/10/secure-gitlab-letsencrypt/">Bảo mật Gitlab với Let&#39;s Encrypt</a>
          </li>
        
          <li>
            <a href="/2017/10/single-action-controller/">Single Action Controller</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 tuduydongian.com
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>